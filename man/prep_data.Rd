% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{prep_data}
\alias{prep_data}
\title{Data preprocessing for FIRM integration}
\usage{
prep_data(counts, file_path = NULL, file_name = NULL, hvg_genes = 4000)
}
\arguments{
\item{counts}{Raw count matrix (genes Ã— cells) or \code{dgCMatrix}.}

\item{file_path}{Optional directory where results should be **saved**.
If \code{NULL} (default) nothing is written to disk.}

\item{file_name}{Optional basename for saved \code{.RData} files.
When given, two files are created:
\code{<file_name>.RData} (Seurat object) and
\code{<file_name>_hvg.RData} (character vector of HVGs).}

\item{hvg_genes}{Target number of genes to return (default 4 000).}
}
\value{
A named list with elements
         \describe{
           \item{Dataset}{Seurat object after normalization, scaling and
                          feature selection.}
           \item{hvg}{Character vector of the 4 000 most variable genes.}
         }
}
\description{
Performs a standard Seurat workflow: normalization, scaling and
selection of the top 4 000 highly-variable genes (HVGs).
}
\examples{
\dontrun{
data("ExampleData")
prep_SS2  <- prep_data(SS2)
Dataset1  <- prep_SS2$Dataset
hvg1      <- prep_SS2$hvg

prep_tenx <- prep_data(tenx)
Dataset2  <- prep_tenx$Dataset
hvg2      <- prep_tenx$hvg

# save results to disk
prep_data(tenx,
          file_path = tempdir(),
          file_name = "tenx_processed")
}

}
\seealso{
\code{\link{FIRM}} for the integration step.
}
\author{
Jingsi Ming
}
